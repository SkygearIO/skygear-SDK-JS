<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
    integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4"
    crossorigin="anonymous"
  >
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  <link rel="stylesheet" href="example.css">
  <title>Skygear-SDK-JS examples</title>
</head>

<body>
  <script src="/bundle.js"></script>

  <div class="container my-3" style="max-width: 850px">
    <div class="row">
      <div class="col-sm-9">
        <div id="current-info"></div>

        <!-- Login -->
        <div class="section section-login">
          <h2>Login</h2>

          <div id="loginWithUsername">
            <code>loginWithUsername(username, password)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); loginWithUserName()">
              <div class="form-group mb-2">
                <label for="username" class="sr-only">Username</label>
                <input type="text" class="form-control" id="username" placeholder="Username" required>
              </div>
              <div class="form-group mx-sm-3 mb-2">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function loginWithUserName() {
                var demo = document.getElementById('loginWithUsername')
                var terminal = demo.querySelector('#terminal')

                var username = demo.getElementById('username').value
                var password = demo.getElementById('password').value

                return skygear.auth.loginWithUsername(username, password)
                  .then(function(res) {
                    terminal.value = JSON.stringify(res, null, 4)
                  })
                  .catch(function(err) {
                    terminal.value = JSON.stringify(err, null, 4)
                  })
              }
            </script>
          </div>

          <div id="loginWithEmail">
            <code>loginWithEmail(email, password)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); loginWithEmail()">
              <div class="form-group mb-2">
                <label for="email" class="sr-only">Email</label>
                <input type="text" class="form-control" id="email" placeholder="Email" required>
              </div>
              <div class="form-group mx-sm-3 mb-2">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function loginWithEmail() {
                var username = document.querySelectorAll('#loginWithEmail #email')[0].value
                var password = document.querySelectorAll('#loginWithEmail #password')[0].value

                return logP(document.querySelectorAll('#loginWithEmail #terminal')[0])(skygear.auth.loginWithEmail(email, password))
              }
          </script>
          </div>

          <div id="loginWithCustomToken">
            <code>loginWithCustomToken(token)</code>

            <form class="form-inline" onsubmit="event.preventDefault(); loginWithCustomToken()">
              <div class="form-group mr-sm-3 mb-2">
                <label for="token" class="sr-only">Token</label>
                <input type="password" class="form-control" id="token" placeholder="Custom token">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function loginWithCustomToken() {
                var token = document.querySelectorAll('#loginWithCustomToken #token')[0].value

                return logP(document.querySelectorAll('#loginWithCustomToken #terminal')[0])(skygear.auth.loginWithCustomToken(token))
              }
            </script>
          </div>
        </div>

        <div class="section section-signup">
          <h2>Signup</h2>

          <div id="signupAnonymously">
            <code>signupAnonymously()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); signupAnonymously()">
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function signupAnonymously() {
                return logP(document.querySelectorAll('#signupAnonymously #terminal')[0])(skygear.auth.signupAnonymously())
              }
            </script>
          </div>

          <div id="signup">
            <code>signup()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); signup()">
              <div class="form-group md-3 mb-2">
                <label for="username" class="sr-only">Username</label>
                <input type="text" class="form-control" id="username" placeholder="Username" required>
              </div>
              <div class="form-group mx-sm-3 mb-2">
                <label for="email" class="sr-only">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Email" required>
              </div>
              <div class="form-group mb-2 mr-sm-3">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function signup() {
                var username = document.querySelectorAll('#signup #username')[0].value
                var email = document.querySelectorAll('#signup #email')[0].value
                var password = document.querySelectorAll('#signup #password')[0].value

                return logP(document.querySelectorAll('#signup #terminal')[0])(skygear.auth.signup({
                  username: username,
                  email: email
                }, password))
              }
            </script>
          </div>

          <div id="signupWithUsername">
            <code>signupWithUsername()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); signupWithUsername()">
              <div class="form-group md-3 mb-2">
                <label for="username" class="sr-only">Username</label>
                <input type="text" class="form-control" id="username" placeholder="Username" required>
              </div>
              <div class="form-group mb-2 mr-sm-3">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function signupWithUsername() {
                var username = document.querySelectorAll('#signupWithUsername #username')[0].value
                var password = document.querySelectorAll('#signupWithUsername #password')[0].value

                return logP(document.querySelectorAll('#signupWithUsername #terminal')[0])(skygear.auth.signupWithUsername(username, password))
              }
            </script>
          </div>

          <div id="signupWithEmail">
            <code>signupWithEmail()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); signupWithEmail()">
              <div class="form-group mx-sm-3 mb-2">
                <label for="email" class="sr-only">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Email" required>
              </div>
              <div class="form-group mb-2  mx-sm-3">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function signupWithEmail() {
                var email = document.querySelectorAll('#signupWithEmail #email')[0].value
                var password = document.querySelectorAll('#signupWithEmail #password')[0].value

                return logP(document.querySelectorAll('#signupWithEmail #terminal')[0])(skygear.auth.signupWithEmail(email, password))
              }
            </script>
          </div>
        </div>

        <!-- Logout -->
        <div class="section section-logout">
          <h2>Logout</h2>

          <div id="logout">
            <code>logout()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); logout()">
              <button type="submit" class="btn btn-primary mb-2">Logout</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function logout() {
                return logP(document.querySelectorAll('#logout #terminal')[0])(skygear.auth.logout())
              }
          </script>
          </div>
        </div>

        <!-- Forgot Password -->
        <div class="section section-forgort-password">
          <h2>Forgot Password</h2>

          <div id="forgotPassword">
            <code>forgotPassword(email)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); forgotPassword()">
              <div class="form-group mb-2">
                <label for="email" class="sr-only">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Email" required>
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function forgotPassword() {
              var email = document.querySelectorAll('#forgotPassword #email')[0].value

              return logP(document.querySelectorAll('#forgotPassword #terminal')[0])(skygear.auth.forgotPassword(email))
            }
          </script>
          </div>
        </div>

        <!-- Reset Password -->
        <div class="section section-reset-password">
          <h2>Reset Password</h2>

          <div id="resetPassword">
            <code>resetPassword(email)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); resetPassword()">
              <div class="form-group mb-2">
                <label for="userID" class="sr-only">User ID</label>
                <input type="text" class="form-control" id="userID" placeholder="User ID" required>
              </div>
              <div class="form-group mb-2 mx-sm-3">
                <label for="code" class="sr-only">Code</label>
                <input type="text" class="form-control" id="code" placeholder="Code" required>
              </div>
              <div class="form-group mb-2">
                <label for="expireAt" class="sr-only">Expire At</label>
                <input type="text" class="form-control" id="expireAt" placeholder="Expire At" required>
              </div>
              <div class="form-group mb-2 mx-sm-3">
                <label for="password" class="sr-only">New Password</label>
                <input type="password" class="form-control" id="password" placeholder="New Password" required>
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function resetPassword() {
                var userID = document.querySelectorAll('#resetPassword #userID')[0].value
                var code = document.querySelectorAll('#resetPassword #code')[0].value
                var expireAt = document.querySelectorAll('#resetPassword #expireAt')[0].value
                var newPassword = document.querySelectorAll('#resetPassword #password')[0].value

                return logP(document.querySelectorAll('#resetPassword #terminal')[0])(skygear.auth.resetPassword(userID, code, expireAt, newPassword))
              }
          </script>
          </div>
        </div>

        <!-- Change Password -->
        <div class="section section-change-password">
          <h2>Change Password</h2>

          <div id="changePassword">
            <code>changePassword(old_password, new_password)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); changePassword()">
              <div class="form-group mb-2">
                <label for="oldPassword" class="sr-only">Current Password</label>
                <input type="password" class="form-control" id="oldPassword" placeholder="Current Password" required>
              </div>
              <div class="form-group mb-2 mx-sm-3">
                <label for="newPassword" class="sr-only">New Password</label>
                <input type="password" class="form-control" id="newPassword" placeholder="New Password" required>
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function changePassword() {
                var oldPassword = document.querySelectorAll('#changePassword #oldPassword')[0].value
                var newPassword = document.querySelectorAll('#changePassword #newPassword')[0].value

                return logP(document.querySelectorAll('#changePassword #terminal')[0])(skygear.auth.changePassword(oldPassword, newPassword))
              }
          </script>
          </div>
        </div>

        <!-- User Discovery -->
        <div class="section section-user-discovery">
          <h2>User Discovery</h2>

          <div id="whoami">
            <code>whoami()</code>
            <form class="form-inline" onsubmit="event.preventDefault(); whoami()">
              <button type="submit" class="btn btn-primary mb-2">Who am I?</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function whoami() {
                return logP(document.querySelectorAll('#whoami #terminal')[0])(skygear.auth.whoami())
              }
            </script>
          </div>

          <div id="discoverUserByEmails">
            <code>discoverUserByEmails([email])</code>
            <form class="form-inline" onsubmit="event.preventDefault(); discoverUserByEmails()">
              <div class="form-group mb-2">
                <label for="email" class="sr-only">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Email" required>
              </div>
              <button type="submit" class="btn btn-primary mb-2">Discover</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function discoverUserByEmails() {
                var email = document.querySelectorAll('#discoverUserByEmails #email')[0].value

                return logP(document.querySelectorAll('#discoverUserByEmails #terminal')[0])(skygear.auth.discoverUserByEmails([email]))
              }
            </script>
          </div>

          <div id="discoverUserByUsernames">
            <code>discoverUserByUsernames([username])</code>
            <form class="form-inline" onsubmit="event.preventDefault(); discoverUserByUsernames()">
              <div class="form-group mb-2">
                <label for="username" class="sr-only">Username</label>
                <input type="username" class="form-control" id="username" placeholder="Username" required>
              </div>
              <button type="submit" class="btn btn-primary mb-2">Discover</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function discoverUserByUsernames() {
                var username = document.querySelectorAll('#discoverUserByUsernames #username')[0].value

                return logP(document.querySelectorAll('#discoverUserByUsernames #terminal')[0])(skygear.auth.discoverUserByUsernames([username]))
              }
           </script>
          </div>
        </div>

        <!-- Admin -->
        <div class="section section-admin">
          <h2>Admin</h2>

          <div id="adminResetPassword">
            <code>adminResetPassword(userID, password)</code>
            <form class="form-inline" onsubmit="event.preventDefault(); adminResetPassword()">
              <div class="form-group mb-2">
                <label for="userID" class="sr-only">User ID</label>
                <input type="text" class="form-control" id="userID" placeholder="User ID" required>
              </div>
              <div class="form-group mx-sm-3 mb-2">
                <label for="password" class="sr-only">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function adminResetPassword() {
                var userID = document.querySelectorAll('#adminResetPassword #userID')[0].value
                var password = document.querySelectorAll('#adminResetPassword #password')[0].value

                return logP(document.querySelectorAll('#adminResetPassword #terminal')[0])(skygear.auth.adminResetPassword(userID, password))
              }
            </script>
          </div>
        </div>

        <!-- Record -->
        <div class="section section-record">
          <h2>Record</h2>

          <div id="saveRecord">
            <code>saveRecord(record)</code>
            <form class="form" onsubmit="event.preventDefault(); saveRecord()">
              <div class="form-group mb-2">
                <label for="type">Record Type</label>
                <input type="text" class="form-control" id="type" placeholder="Record Type" value="note" required>
              </div>
              <div class="form-group">
                <label for="payload">JSON Payload</label>
                <textarea class="form-control" id="payload" rows="3">{
  "body": "Hello World"
}</textarea>
              </div>
              <div class="form-group">
                <input id="auto-increment" type="checkbox"/>
                <label for="auto-increment" class="form-check-label">Include auto increment ID</label>
                <input class="form-control" style="display: inline-block; width:calc(100% - 194px);" id="auto-increment-id" type="text" value="noteID">
              </div>
              <button type="submit" class="btn btn-primary mb-2">Submit</button>
            </form>

            <textarea id="terminal" class="form-control" cols="20" rows="6" readonly></textarea>

            <script>
              function saveRecord() {
                var _type = document.querySelectorAll('#saveRecord #type')[0].value
                var payload = document.querySelectorAll('#saveRecord #payload')[0].value
                var sequenceEnabled = document.querySelectorAll('#saveRecord #auto-increment')[0].checked
                var sequenceName = document.querySelectorAll('#saveRecord #auto-increment-id')[0].value

                var _Record = skygear.Record.extend(_type)
                var attrs = JSON.parse(payload)
                var record = new _Record(attrs)

                if (sequenceEnabled && sequenceName) {
                  record[sequenceName] = new skygear.Sequence()
                }

                return logP(document.querySelectorAll('#saveRecord #terminal')[0])(skygear.publicDB.saveRecord(record))
              }
          </script>
          </div>
        </div>


      </div>
      <div class="col-sm-3">
      </div>
    </div>
  </div>

  <script src="current-info.js"></script>
  <script>
    skygear.config({
      'endPoint': '{{ SKYGEAR_ENDPOINT }}',
      'apiKey': '{{ SKYGEAR_API_KEY }}'
    }).then(function(container) {
      console.log('Skygear successfully configured')
      initCurrentInfo()
    }, function(err) {
      console.error(err);
    })
  </script>
</body>

</html>
